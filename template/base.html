<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>{% block title %}SideCrew{% endblock %}</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'assets/img/favicon.ico' %}">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* === LEAFLET STYLE (FOR MAPS) === */
        .leaflet-container {
            height: 400px;
            width: 100%;
            border-radius: 0.5rem; /* 8px */
            z-index: 0; /* Fixes conflict with Tailwind */
        }

        {% block styles %}
        .hero-bg {
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url("{% static 'assets/img/hero/h1_hero.jpg' %}");
            background-size: cover;
            background-position: center;
        }
        {% endblock %}
    </style>
</head>
<body class="bg-white text-slate-800">

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="/" class="flex items-center space-x-2">
                <svg class="h-8 w-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">
                    <path d="M16.5 8.25C17.9011 8.25 19.1678 8.78191 20.1213 9.73541C21.0748 10.6889 21.6067 11.9556 21.6067 13.3567C21.6067 14.7578 21.0748 16.0245 20.1213 16.978C19.1678 17.9315 17.9011 18.4634 16.5 18.4634L16.5 21C19.5376 21 22.0152 19.5165 23.4975 17.5C24.3015 16.4215 24.75 14.9624 24.75 13.3567C24.75 11.751 24.3015 10.2919 23.4975 9.21342C22.0152 7.19692 19.5376 5.71342 16.5 5.71342L16.5 8.25Z" fill="currentColor" class="text-slate-400"/>
                    <path d="M7.5 15.75C6.09891 15.75 4.83218 15.2181 3.87868 14.2646C2.92518 13.3111 2.39327 12.0444 2.39327 10.6433C2.39327 9.24219 2.92518 7.97546 3.87868 7.02196C4.83218 6.06846 6.09891 5.53655 7.5 5.53655L7.5 3C4.46244 3 1.98481 4.4835 0.502502 6.5C-0.301501 7.57849 -0.75 9.03761 -0.75 10.6433C-0.75 12.249 -0.301501 13.7081 0.502502 14.7866C1.98481 16.8031 4.46244 18.2866 7.5 18.2866L7.5 15.75Z" fill="currentColor" class="text-blue-600"/>
                </svg>
                <span class="text-2xl font-extrabold text-slate-900 tracking-tight">SideCrew</span>
            </a>

            <div class="hidden md:flex items-center space-x-2">
                {% if request.session.is_loggedin %}
                    {% if request.session.user_role == 'client' %}
                        <a href="{% url 'client_home' %}" class="font-medium text-slate-600 hover:text-blue-600 hover:bg-slate-100 px-3 py-2 rounded-md transition-colors">Dashboard</a>
                        <a href="{% url 'create_job' %}" class="font-medium text-slate-600 hover:text-blue-600 hover:bg-slate-100 px-3 py-2 rounded-md transition-colors">Post a Job</a>
                    {% elif request.session.user_role == 'worker' %}
                        <a href="{% url 'worker_home' %}" class="font-medium text-slate-600 hover:text-blue-600 hover:bg-slate-100 px-3 py-2 rounded-md transition-colors">Dashboard</a>
                        <a href="{% url 'worker_home' %}" class="font-medium text-slate-600 hover:text-blue-600 hover:bg-slate-100 px-3 py-2 rounded-md transition-colors">Available Jobs</a>
                    {% elif request.session.user_role == 'agent' %}
                        <a href="{% url 'agent_home' %}" class="font-medium text-slate-600 hover:text-blue-600 hover:bg-slate-100 px-3 py-2 rounded-md transition-colors">Agent Dashboard</a>
                    {% elif request.session.user_role == 'admin' %}
                        <a href="{% url 'admin_home' %}" class="font-medium text-slate-600 hover:text-blue-600 hover:bg-slate-100 px-3 py-2 rounded-md transition-colors">Admin Dashboard</a>
                    {% endif %}
                {% else %}
                    {% endif %}
            </div>

            <div class="flex items-center space-x-4">

                <div class="hidden md:flex items-center space-x-4">
                    {% if request.session.is_loggedin %}
                        <div class="relative group">
                            <button id="profile-button" class="flex items-center space-x-2 text-slate-600 font-medium hover:bg-slate-100 p-2 rounded-lg transition-colors">
                                <span class="inline-block h-8 w-8 rounded-full overflow-hidden bg-slate-200">
                                    <svg class="h-full w-full text-slate-500" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z" />
                                    </svg>
                                </span>
                                <span>
                                    {% if request.session.user_role == 'client' %}
                                        {{ request.session.client_name }}
                                    {% elif request.session.user_role == 'agent' %}
                                        {{ request.session.agent_name }}
                                    {% elif request.session.user_role == 'worker' %}
                                        {{ request.session.worker_name }}
                                    {% elif request.session.user_role == 'admin' %}
                                        Admin
                                    {% endif %}
                                </span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                            </button>
                            <div id="profile-menu" class="absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-1 z-20 hidden">
                                {% if request.session.user_role == 'client' %}
                                    <a href="{% url 'client_profile' %}" class="flex items-center px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">
                                        <svg class="w-5 h-5 mr-3 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                        My Profile
                                    </a>
                                {% elif request.session.user_role == 'agent' %}
                                    <a href="{% url 'agent_profile' %}" class="flex items-center px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">
                                        <svg class="w-5 h-5 mr-3 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                        My Profile
                                    </a>
                                {% elif request.session.user_role == 'worker' %}
                                    <a href="{% url 'worker_profile' %}" class="flex items-center px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">
                                        <svg class="w-5 h-5 mr-3 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                        My Profile
                                    </a>
                                {% endif %}
                                <hr class="my-1">
                                <a href="{% url 'user_logout' %}" class="flex items-center px-4 py-2 text-sm text-red-600 hover:bg-slate-100">
                                     <svg class="w-5 h-5 mr-3 text-red-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
                                    Logout
                                </a>
                            </div>
                        </div>
                    {% else %}
                        <div class="relative">
                            <button id="login-button" class="text-slate-600 font-medium hover:text-blue-600 hover:bg-slate-100 px-3 py-2 rounded-md transition-colors flex items-center">
                                <span>Log In</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                            </button>
                            <div id="login-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20 hidden">
                                <a href="{% url 'client_login' %}" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">As a Client</a>
                                <a href="{% url 'worker_login' %}" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">As a Worker</a>
                                <a href="{% url 'agent_login' %}" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">As an Agent</a>
                                <a href="{% url 'admin_login' %}" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">As an Admin</a>
                            </div>
                        </div>
                        <div class="relative">
                            <button id="signup-button" class="bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                                <span>Sign Up</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                            </button>
                            <div id="signup-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20 hidden">
                                <a href="{% url 'client_register' %}" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">As a Client</a>
                                <a href="{% url 'worker_register' %}" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">As a Worker</a>
                                <a href="{% url 'agent_register' %}" class="block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">As an Agent</a>
                            </div>
                        </div>
                    {% endif %}
                </div>

                <button id="mobile-menu-button" class="md:hidden text-slate-800">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                    </svg>
                </button>
            </div>
        </nav>

        <div id="mobile-menu" class="md:hidden hidden bg-white shadow-lg border-t">
            <div class="px-4 pt-4 pb-6 space-y-4">
                {% if request.session.is_loggedin %}

                    <h3 class="text-sm font-semibold text-slate-500 uppercase">My Dashboard</h3>
                    {% if request.session.user_role == 'client' %}
                        <a href="{% url 'client_home' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">Dashboard</a>
                        <a href="{% url 'client_profile' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">My Profile</a>
                        <a href="{% url 'create_job' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">Post a Job</a>
                    {% elif request.session.user_role == 'worker' %}
                        <a href="{% url 'worker_home' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">Dashboard</a>
                        <a href="{% url 'worker_profile' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">My Profile</a>
                        <a href="{% url 'worker_home' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">Available Jobs</a>
                    {% elif request.session.user_role == 'agent' %}
                        <a href="{% url 'agent_home' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">Agent Dashboard</a>
                        <a href="{% url 'agent_profile' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">My Profile</a>
                    {% endif %}
                    <a href="{% url 'user_logout' %}" class="block w-full text-left text-base font-medium text-red-600 hover:bg-red-50 p-2 rounded-lg">Logout</a>

                {% else %}

                    <h3 class="text-sm font-semibold text-slate-500 uppercase">Log In</h3>
                    <a href="{% url 'client_login' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">As a Client</a>
                    <a href="{% url 'worker_login' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">As a Worker</a>
                    <a href="{% url 'agent_login' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">As an Agent</a>

                    <a href="{% url 'admin_login' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">As an Admin</a>

                    <hr class="my-4">

                    <h3 class="text-sm font-semibold text-slate-500 uppercase">Sign Up</h3>
                    <a href="{% url 'client_register' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">As a Client</a>
                    <a href="{% url 'worker_register' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">As a Worker</a>
                    <a href="{% url 'agent_register' %}" class="block text-base font-medium text-slate-700 hover:bg-slate-100 p-2 rounded-lg">As an Agent</a>
                {% endif %}
            </div>
        </div>
    </header>

    <main>
        {% block content %}
        {% endblock %}
    </main>

    <footer class="bg-slate-900 text-slate-400">
        <div class="container mx-auto px-6 py-8">
            <div class="flex flex-col md:flex-row justify-between items-center space-y-6 md:space-y-0">
                <a href="/" class="flex items-center space-x-2">
                    <svg class="h-7 w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">
                        <path d="M16.5 8.25C17.9011 8.25 19.1678 8.78191 20.1213 9.73541C21.0748 10.6889 21.6067 11.9556 21.6067 13.3567C21.6067 14.7578 21.0748 16.0245 20.1213 16.978C19.1678 17.9315 17.9011 18.4634 16.5 18.4634L16.5 21C19.5376 21 22.0152 19.5165 23.4975 17.5C24.3015 16.4215 24.75 14.9624 24.75 13.3567C24.75 11.751 24.3015 10.2919 23.4975 9.21342C22.0152 7.19692 19.5376 5.71342 16.5 5.71342L16.5 8.25Z" fill="currentColor" class="text-slate-500"/>
                        <path d="M7.5 15.75C6.09891 15.75 4.83218 15.2181 3.87868 14.2646C2.92518 13.3111 2.39327 12.0444 2.39327 10.6433C2.39327 9.24219 2.92518 7.97546 3.87868 7.02196C4.83218 6.06846 6.09891 5.53655 7.5 5.53655L7.5 3C4.46244 3 1.98481 4.4835 0.502502 6.5C-0.301501 7.57849 -0.75 9.03761 -0.75 10.6433C-0.75 12.249 -0.301501 13.7081 0.502502 14.7866C1.98481 16.8031 4.46244 18.2866 7.5 18.2866L7.5 15.75Z" fill="currentColor" class="text-blue-500"/>
                    </svg>
                    <span class="text-xl font-bold text-white">SideCrew</span>
                </a>
                <div class="flex space-x-6 md:space-x-8 text-sm">
                    <a href="/#about" class="hover:text-white transition-colors">About Us</a>
                    <a href="#" class="hover:text-white transition-colors">Post a Job</a>
                    <a href="#" class="hover:text-white transition-colors">Find Work</a>
                    <a href="/#contact" class="hover:text-white transition-colors">Contact</a>
                </div>
                <div class="flex space-x-4">
                    <a href="#" aria-label="Facebook" class="hover:text-white transition-colors">
                        <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22.675 0h-21.35C.582 0 0 .582 0 1.325v21.351C0 23.418.582 24 1.325 24H12.82v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116c.742 0 1.325-.582 1.325-1.325V1.325C24 .582 23.418 0 22.675 0z"/>
                        </svg>
                    </a>
                    <a href="#" aria-label="Twitter" class="hover:text-white transition-colors">
                        <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616v.064c0 2.298 1.634 4.212 3.793 4.649-.418.113-.86.173-1.32.173-.305 0-.6-.03-.888-.086.608 1.884 2.373 3.268 4.465 3.306-1.622 1.276-3.666 2.035-5.885 2.035-.383 0-.761-.022-1.134-.067 2.099 1.35 4.596 2.148 7.29 2.148 8.749 0 13.529-7.249 13.529-13.529 0-.206-.005-.412-.013-.618.928-.67 1.733-1.512 2.37-2.457z"/>
                        </svg>
                    </a>
                    <a href="#" aria-label="LinkedIn" class="hover:text-white transition-colors">
                         <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.225 0z"/>
                        </svg>
                    </a>
                </div>
            </div>
            <div class="mt-8 pt-6 border-t border-slate-700 text-center">
                <p class="text-sm">&copy; {% now "Y" %} SideCrew. All rights reserved. Kozhikode, Kerala.</p>
            </div>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const loginButton = document.getElementById('login-button');
            const loginMenu = document.getElementById('login-menu');
            const signupButton = document.getElementById('signup-button');
            const signupMenu = document.getElementById('signup-menu');
            const profileButton = document.getElementById('profile-button');
            const profileMenu = document.getElementById('profile-menu');

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            const closeAllMenus = () => {
                if (loginMenu) loginMenu.classList.add('hidden');
                if (signupMenu) signupMenu.classList.add('hidden');
                if (profileMenu) profileMenu.classList.add('hidden');

                if (mobileMenu) mobileMenu.classList.add('hidden');
            };

            const setupButtonListener = (button, menu) => {
                if (button) {
                    button.addEventListener('click', (event) => {
                        event.stopPropagation();
                        const isHidden = menu.classList.contains('hidden');
                        closeAllMenus();
                        if (isHidden) {
                            menu.classList.remove('hidden');
                        }
                    });
                }
            };

            setupButtonListener(loginButton, loginMenu);
            setupButtonListener(signupButton, signupMenu);
            setupButtonListener(profileButton, profileMenu);

            if (mobileMenuButton) {
                mobileMenuButton.addEventListener('click', (event) => {
                    event.stopPropagation();
                    // Close other desktop menus
                    if (loginMenu) loginMenu.classList.add('hidden');
                    if (signupMenu) signupMenu.classList.add('hidden');
                    if (profileMenu) profileMenu.classList.add('hidden');

                    // Toggle the mobile menu
                    mobileMenu.classList.toggle('hidden');
                });
            }

            window.addEventListener('click', (event) => {
                closeAllMenus();
            });
        });
    </script>
    {% block extra_scripts %}
    {% endblock %}

</body>
</html>